{% extends "index.html" %}
{% block content %}

<style>
  .result-container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
  .result-header { text-align: center; margin-bottom: 40px; padding: 30px 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 20px; color: white; }
  .result-header h1 { font-size: 32px; font-weight: 700; margin-bottom: 10px; }
  .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
  @media (max-width: 768px) { .result-grid { grid-template-columns: 1fr; } }
  .image-section { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08); text-align: center; }
  .disease-image { width: 100%; max-width: 500px; border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1); margin-bottom: 15px; }
  .image-caption { font-size: 14px; color: #6b7280; font-style: italic; }
  .detection-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08); }
  .severity-badge { display: inline-block; padding: 8px 20px; border-radius: 20px; font-weight: 600; font-size: 14px; margin-top: 10px; }
  .severity-low { background: #d1fae5; color: #065f46; }
  .severity-moderate { background: #fef3c7; color: #92400e; }
  .severity-high { background: #fed7aa; color: #9a3412; }
  .severity-critical { background: #fecaca; color: #991b1b; }
  .severity-unknown { background: #e5e7eb; color: #374151; }
  .disease-title { font-size: 28px; font-weight: 700; color: #111827; margin: 15px 0; }
  .crop-label { display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px; background: #f0fdf4; border: 1px solid #10b981; border-radius: 20px; color: #059669; font-size: 14px; font-weight: 600; }
  .description-text { color: #4b5563; line-height: 1.7; margin: 20px 0; }
  .info-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08); margin-bottom: 30px; }
  .info-card h3 { font-size: 20px; font-weight: 700; color: #111827; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
  .info-card h3 i { color: #10b981; }
  .list-items { list-style: none; padding: 0; }
  .list-items li { padding: 12px 0; border-bottom: 1px solid #e5e7eb; display: flex; align-items: start; gap: 12px; }
  .list-items li:last-child { border-bottom: none; }
  .list-items li i { color: #10b981; margin-top: 4px; flex-shrink: 0; }
  .treatment-tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e5e7eb; flex-wrap: wrap; }
  .tab-btn { padding: 12px 24px; background: none; border: none; color: #6b7280; font-weight: 600; cursor: pointer; transition: all 0.3s; border-bottom: 3px solid transparent; margin-bottom: -2px; }
  .tab-btn.active { color: #10b981; border-bottom-color: #10b981; }
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  .impact-alert { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 12px; margin: 20px 0; }
  .impact-alert h4 { font-size: 16px; font-weight: 700; color: #92400e; margin-bottom: 10px; }
  .impact-alert p { color: #78350f; margin: 0; }
  .timeline-badge { background: #e0e7ff; color: #3730a3; padding: 8px 16px; border-radius: 20px; display: inline-block; font-weight: 600; font-size: 14px; }
  .action-buttons { display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; }
  .btn-primary { padding: 14px 28px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white !important; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-block; }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); }
  .btn-secondary { padding: 14px 28px; background: white; color: #10b981 !important; border: 2px solid #10b981; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-block; }
  .btn-secondary:hover { background: #f0fdf4; transform: translateY(-2px); }
  .tips-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
  .tip-card { background: #f9fafb; padding: 15px; border-radius: 12px; border-left: 4px solid #10b981; }
  .tip-card i { color: #10b981; margin-right: 8px; }
</style>

<div class="result-container">
  <div class="result-header">
    <h1><i class="fas fa-microscope me-2"></i>Disease Analysis Results</h1>
    <p>Comprehensive AI-powered disease detection and treatment recommendations</p>
  </div>

  <div class="result-grid">
    <div class="image-section">
      <img src="{{ url_for('send_file', filename=image_file_name) }}" class="disease-image">
      <p class="image-caption">{{ image_file_name }}</p>
    </div>

    <div class="detection-card">
      <span class="crop-label"><i class="fas fa-leaf"></i> {{ crop|capitalize }}</span>
      <h2 class="disease-title">{{ analysis.disease_name }}</h2>
      <span class="severity-badge severity-{{ analysis.severity|lower }}">
        <i class="fas fa-exclamation-triangle me-1"></i>{{ analysis.severity }} Severity
      </span>
      <p class="description-text">{{ analysis.description }}</p>
      <div class="impact-alert">
        <h4><i class="fas fa-chart-line me-2"></i>Potential Impact</h4>
        <p>{{ analysis.impact }}</p>
      </div>
      <div style="margin-top: 20px;">
        <i class="fas fa-clock me-2" style="color: #6b7280;"></i>
        <strong>Treatment Timeline:</strong>
        <span class="timeline-badge ms-2">{{ analysis.timeline }}</span>
      </div>
    </div>
  </div>

  <div class="info-card">
    <h3><i class="fas fa-stethoscope"></i>Symptoms</h3>
    <ul class="list-items">
      {% for symptom in analysis.symptoms %}
      <li><i class="fas fa-check-circle"></i><span>{{ symptom }}</span></li>
      {% endfor %}
    </ul>
  </div>

  <div class="info-card">
    <h3><i class="fas fa-virus"></i>Causes</h3>
    <ul class="list-items">
      {% for cause in analysis.causes %}
      <li><i class="fas fa-arrow-right"></i><span>{{ cause }}</span></li>
      {% endfor %}
    </ul>
  </div>

  <div class="info-card">
    <h3><i class="fas fa-medkit"></i>Treatment Recommendations</h3>
    <div class="treatment-tabs">
      <button class="tab-btn active" onclick="switchTab(event, 'immediate')"><i class="fas fa-bolt me-1"></i>Immediate Actions</button>
      <button class="tab-btn" onclick="switchTab(event, 'chemical')"><i class="fas fa-flask me-1"></i>Chemical Treatment</button>
      <button class="tab-btn" onclick="switchTab(event, 'organic')"><i class="fas fa-leaf me-1"></i>Organic Treatment</button>
    </div>
    <div id="immediate" class="tab-content active">
      <ul class="list-items">
        {% for action in analysis.treatment.immediate_actions %}
        <li><i class="fas fa-exclamation-circle"></i><span>{{ action }}</span></li>
        {% endfor %}
      </ul>
    </div>
    <div id="chemical" class="tab-content">
      <ul class="list-items">
        {% for chemical in analysis.treatment.chemical_treatment %}
        <li><i class="fas fa-vial"></i><span>{{ chemical }}</span></li>
        {% endfor %}
      </ul>
    </div>
    <div id="organic" class="tab-content">
      <ul class="list-items">
        {% for organic in analysis.treatment.organic_treatment %}
        <li><i class="fas fa-seedling"></i><span>{{ organic }}</span></li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="info-card">
    <h3><i class="fas fa-shield-alt"></i>Prevention Methods</h3>
    <ul class="list-items">
      {% for prevention in analysis.prevention %}
      <li><i class="fas fa-check"></i><span>{{ prevention }}</span></li>
      {% endfor %}
    </ul>
  </div>

  <div class="info-card">
    <h3><i class="fas fa-lightbulb"></i>Additional Tips</h3>
    <div class="tips-grid">
      {% for tip in analysis.additional_tips %}
      <div class="tip-card"><i class="fas fa-info-circle"></i><span>{{ tip }}</span></div>
      {% endfor %}
    </div>
  </div>

  <div class="action-buttons">
    <a href="/disease-prediction" class="btn-primary"><i class="fas fa-redo me-2"></i>New Analysis</a>
    <a href="/farmbot" class="btn-secondary"><i class="fas fa-robot me-2"></i>Ask Farm Bot</a>
    <a href="/dashboard" class="btn-secondary"><i class="fas fa-home me-2"></i>Dashboard</a>
    <button onclick="window.print()" class="btn-secondary"><i class="fas fa-print me-2"></i>Print Report</button>
  </div>
</div>

<script>
  function switchTab(event, tabName) {
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
  }
</script>

{% endblock %}
